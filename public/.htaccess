<IfModule mod_rewrite.c>
	RewriteEngine On
	RewriteBase /

	RewriteCond %{HTTPS}s ^(on(s)|offs)$
	RewriteRule ^ - [env=s:%2]

	RewriteCond %{HTTP_HOST} ^www\.(.*)
	RewriteRule ^.*$ http%{ENV:s}://%1/$1 [R=301,L]

	RewriteCond %{REQUEST_FILENAME} !-f
	RewriteRule . /index.php [L]
	RewriteRule ^index\.php$ - [L]
</IfModule>

AddOutputFilterByType DEFLATE text/plain
AddOutputFilterByType DEFLATE text/html
AddOutputFilterByType DEFLATE text/xml
AddOutputFilterByType DEFLATE text/css
AddOutputFilterByType DEFLATE text/javascript
AddOutputFilterByType DEFLATE application/xml
AddOutputFilterByType DEFLATE application/xhtml+xml
AddOutputFilterByType DEFLATE application/rss+xml
AddOutputFilterByType DEFLATE application/atom_xml
AddOutputFilterByType DEFLATE application/javascript
AddOutputFilterByType DEFLATE application/x-javascript
AddOutputFilterByType DEFLATE application/x-shockwave-flash

AddType application/x-font-woff .woff
AddType application/x-font-woff2 .woff2

ExpiresActive On
ExpiresByType text/css "access plus 1 month"
ExpiresByType text/javascript "access plus 1 month"
ExpiresByType application/javascript "access plus 1 month"
ExpiresByType image/gif "access plus 1 month"
ExpiresByType image/jpeg "access plus 1 month"
ExpiresByType image/png "access plus 1 month"
ExpiresByType image/x-icon "access plus 1 month"
ExpiresByType application/x-font-woff "access plus 1 year"
ExpiresByType application/x-font-woff2 "access plus 1 year"

<IfModule mod_headers.c>
	<filesmatch "\\.(ico|jpg|jpeg|png|gif|swf)$">
		Header set Cache-Control "max-age=2592000, public"
	</filesmatch>
	<filesmatch "\\.(css)$">
		Header set Cache-Control "max-age=604800, public"
	</filesmatch>
	<filesmatch "\\.(js)$">
		Header set Cache-Control "max-age=216000, private"
	</filesmatch>
</IfModule>

<FilesMatch "\.(js|jpg|jpeg|gif|png|css)$">
	ExpiresActive on
	ExpiresDefault "access plus 1 month"
	SetOutputFilter DEFLATE
</FilesMatch>
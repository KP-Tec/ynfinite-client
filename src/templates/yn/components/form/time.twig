{% extends "yn/components/form/basic.twig" %}

{% block field %}
	<script>
		window.addEventListener('load', function () {
		var field, field2, startDate, endDate, value, value2;

		const isBetweenCompare = {% if field.compareOperation == "<==>" %}true{% else %}false{% endif %};

		const data = {
			from: {
				unit: '{{ field.restrictions.from.unit }}',
				value: '{{ field.restrictions.from.value }}'
			},
			to: {
				unit: '{{ field.restrictions.to.unit }}',
				value: '{{ field.restrictions.to.value }}'
			},
			value: '{{ field.defaultValue }}'
		}

		if(isBetweenCompare) {
			field = document.getElementById('{{ form.uid }}_{{ field.alias }}_from');
			field2 = document.getElementById('{{ form.uid }}_{{ field.alias }}_to');
		}
		else {
			field = document.getElementById('{{ form.uid }}_{{ field.alias }}');
		}
		

		if (data.from.unit && data.from.value) {
			startDate = moment().subtract(data.from.value, data.from.unit);
			field.setAttribute("min", startDate.format('hh:mm'))
			if(isBetweenCompare) {	
				field2.setAttribute("min", startDate.format('hh:mm'))
			}
		}

		if (data.to.unit && data.to.value) {
			console.log(data.to.value)
			console.log(data.to.unit)
			endDate = moment().add(data.to.value, data.to.unit);
			field.setAttribute("max", endDate.format('hh:mm'))
			if(isBetweenCompare) {	
				field2.setAttribute("max", endDate.format('hh:mm'))
			}
		}

		if (data.value) {
			if(isBetweenCompare) {
				value = moment('{{ field.value[0] }}');
				field.setAttribute("value", value.format('hh:mm'))

				value2 = moment('{{ field.value[1] }}');
				field2.setAttribute("value", value2.format('hh:mm'))
			}
			else {
				value = moment('{{ field.defaultValue }}');
				field.setAttribute("value", value.format('hh:mm'))
			}
		}
	})
	</script>

	{% if field.compareOperation == "<==>" %}
		<div class="yn-form-grid-row">
			<div class="yn-form-grid-field">
				{% if field.placeholder %}<small>{{ field.placeholder }}</small>{% endif %}
				<input data-ynfield="true" id="{{ form.uid }}_{{ field.alias }}_from" type="{{ field.type }}" name="fields{{ parent }}[{{ field.alias }}][]" {% if field.placeholder %}placeholder="{{ field.placeholder }}"{% endif %} {% if field.required %}required{% endif %} {{ field.attributes|raw}}/>
			</div>
			<div class="yn-form-grid-field">
				{% if field.placeholderRange %}<small>{{ field.placeholderRange}}</small>{% endif %}
				<input data-ynfield="true" id="{{ form.uid }}_{{ field.alias }}_to" type="{{ field.type }}" name="fields{{ parent }}[{{ field.alias }}][]" {% if field.placeholderRange %}placeholder="{{ field.placeholderRange }}"{% endif %} {% if field.required %}required{% endif %} {{ field.attributes|raw}}/>
			</div>
		</div>
	{% else %}
		<input data-ynfield="true" id="{{ form.uid }}_{{ field.alias }}" type="{{ field.type }}" name="fields{{ parent }}[{{ field.alias }}]" {% if field.placeholder %}placeholder="{{ field.placeholder }}"{% endif %} {% if field.required %}required{% endif %} {{ field.attributes|raw}}/>
	{% endif %}


{% endblock field %}
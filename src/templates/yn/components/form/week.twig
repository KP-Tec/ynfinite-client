{% extends "yn/components/form/basic.twig" %}

{% block field %}

	<script>
		window.addEventListener('load', function () {
            var startDate, endDate, value;
			
			const data = {
				from: {
					unit: '{{ field.dateRestrictions.from.unit }}',
					value: '{{ field.dateRestrictions.from.value }}'
				},
				to: {
					unit: '{{ field.dateRestrictions.to.unit }}',
					value: '{{ field.dateRestrictions.to.value }}'
				},
				value: '{{field.value}}'
			}

            var field = document.getElementById('{{field.uid}}');

			if(data.from.unit && data.from.value) {
				startDate = moment().subtract(data.from.value, data.from.unit);
				field.setAttribute("min", startDate.weekYear() + "-W" + startDate.isoWeek().toString().padStart(2, "0"))
			}

			if(data.to.unit && data.to.value) {
				endDate = moment().add(data.to.value, data.to.unit);
				field.setAttribute("max", endDate.weekYear() + "-W" + endDate.isoWeek().toString().padStart(2, "0"))
			}
			
            if(data.value) {
				value = moment('{{ field.value }}');
            	field.setAttribute("value", value.weekYear() + "-W" + value.isoWeek().toString().padStart(2, "0"))
			}
        })
	</script>

	<input id="{{field.uid}}" type="{{field.type}}" name="fields[{{field.alias}}]" placeholder="{{field.placeholder}}" {% if field.required %} required {% endif %} {{field.attributes|raw}}/>
{% endblock field %}
